<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Pentest Terminal — 404 NOT FOUND CYBERSEC</title>

<!-- Xterm CSS (wajib agar tidak jebol tampilannya) -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/xterm/css/xterm.css">

<style>
  /* ===== Page & neon box ===== */
  :root{
    --bg:#03040a;
    --card:#07101a;
    --neon:#00eaff;
    --muted:#9fb6bd;
  }

  html,body{height:100%; margin:0; font-family:ui-monospace, SFMono-Regular, Menlo, Monaco, "Roboto Mono", "Courier New", monospace; background:linear-gradient(180deg,#000814 0%, #03040a 100%); color:var(--neon); -webkit-font-smoothing:antialiased;}

  /* center terminal */
  .wrap{
    max-width:1200px;
    margin:28px auto;
    padding:18px;
    box-sizing:border-box;
  }

  /* neon container */
  #term-box{
    background: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
    border-radius:12px;
    border: 1px solid rgba(0,255,255,0.06);
    box-shadow: 0 6px 30px rgba(0,230,255,0.06), 0 0 40px rgba(0,230,255,0.03) inset;
    padding:12px;
    height: calc(100vh - 80px);
    overflow:hidden;
  }

  /* xterm padding */
  .xterm {
    height:100%;
    width:100%;
    border-radius:8px;
  }
  .xterm-screen {
    padding:10px !important;
  }

  /* small info bar */
  .info {
    display:flex;
    gap:12px;
    justify-content:space-between;
    align-items:center;
    margin-bottom:8px;
    color:var(--muted);
    font-size:13px;
  }
  .info .left{color:var(--neon); font-weight:700}
  .hint { color:var(--muted); font-size:12px }

  /* scanline (subtle) */
  .scanline {
    pointer-events:none;
    position:absolute;
    inset:0;
    background: linear-gradient(180deg, rgba(0,255,255,0.00), rgba(0,255,255,0.02) 50%, rgba(0,255,255,0.00));
    mix-blend-mode:screen;
    animation: scan 6s linear infinite;
    opacity:0.06;
  }
  @keyframes scan {0%{transform:translateY(-100%)}100%{transform:translateY(100%)}}

  /* small responsive */
  @media (max-width:720px){
    .wrap{margin:10px}
    .info{flex-direction:column; align-items:flex-start; gap:6px}
  }
</style>
</head>
<body>
  <div class="wrap">
    <div class="info">
      <div class="left">404 NOT FOUND CYBERSEC — Terminal Scanner</div>
      <div class="right hint">Perintah: <strong>help</strong> • <strong>scan example.com</strong> • <strong>dns example.com</strong> • <strong>clear</strong></div>
    </div>

    <div id="term-box">
      <div id="terminal" style="height:100%;"></div>
      <div class="scanline" aria-hidden="true"></div>
    </div>
  </div>

  <!-- Xterm + Fit addon (CDN) -->
  <script src="https://cdn.jsdelivr.net/npm/xterm/lib/xterm.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/xterm-addon-fit/lib/xterm-addon-fit.min.js"></script>

  <script>
  (function(){
    const { Terminal } = window;
    const { FitAddon } = window;
    if (!Terminal) {
      document.getElementById('terminal').innerText = "Xterm.js tidak ditemukan — cek koneksi CDN.";
      return;
    }

    // terminal init
    const term = new Terminal({
      cursorBlink: true,
      fontSize: 14,
      theme: {
        background: "#03040a",
        foreground: "#00f0ff",
        cursor: "#00f0ff"
      },
      cols: 120,
      rows: 30,
    });

    const fitAddon = new FitAddon.Fit();
    term.loadAddon(fitAddon);
    term.open(document.getElementById('terminal'));
    fitAddon.fit();

    // keep fitting on resize
    window.addEventListener('resize', ()=> setTimeout(()=>fitAddon.fit(),50));

    // small audio feedback via CDN (will play only after user interaction)
    const typeUrl = "https://cdn.jsdelivr.net/gh/achtman/sounds@master/keypress1.wav";
    const beepUrl = "https://cdn.jsdelivr.net/gh/achtman/sounds@master/keypress2.wav";
    let typeAudio = null;
    let beepAudio = null;
    function initAudio(){
      if (typeAudio) return;
      try {
        typeAudio = new Audio(typeUrl);
        beepAudio = new Audio(beepUrl);
        typeAudio.volume = 0.25;
        beepAudio.volume = 0.45;
        // some browsers require user gesture before allowed; we'll play after first key
      } catch(e){ typeAudio=null; beepAudio=null; }
    }

    // helper write with newlines
    function writeln(text=""){
      // split into lines to avoid very long write calls
      (String(text)).split('\n').forEach((ln,i)=>{
        term.writeln(ln);
      });
    }

    // Banner / help
    writeln("========================================");
    writeln("   404 NOT FOUND CYBERSEC TERMINAL");
    writeln("========================================");
    writeln("Tip: ketik 'help' lalu tekan Enter");
    term.write("\r\n> ");

    // input buffer
    let buffer = "";

    // utility: print menu
    function showHelp(){
      writeln("");
      writeln("=== MENU (pilih ketik perintah / angka) ===");
      writeln("help                → Tampilkan menu ini");
      writeln("clear               → Bersihkan layar");
      writeln("exit                → Keluar (kembali ke portfolio)");
      writeln("");
      writeln("1 or whois <domain>     → WHOIS lookup");
      writeln("2 or scan <domain>      → Full scan (simulasi + checks)");
      writeln("3 or headers <domain>   → Security headers (simulasi)");
      writeln("4 or dns <domain>       → DNS lookup (nyata via DNS Google)");
      writeln("5 or ssl <domain>       → SSL quick info (simulasi)");
      writeln("");
      writeln("Contoh: scan example.com");
    }

    // helper: simple delay
    const wait = ms => new Promise(r=>setTimeout(r,ms));

    // command handlers (some real, some simulated due to CORS)
    async function cmd_whois(domain){
      if(!domain){ writeln("Gunakan: whois example.com"); return; }
      writeln(`\n[WHOIS] Mencari ${domain} ...`);
      // WHOIS via public API often requires key — kita simulasi ringkas
      await wait(700);
      try{
        // try to use a free service (may fail due to CORS) — attempt but handle gracefully
        const res = await fetch(`https://api.allorigins.win/raw?url=https://who.is/whois/${encodeURIComponent(domain)}`);
        if (res.ok){
          const text = await res.text();
          // extract first 20 lines to keep output readable
          const lines = text.split(/\r?\n/).slice(0,40).join('\n');
          writeln(lines);
          writeln("\n[INFO] Output WHOIS (sourced via proxy).");
          return;
        }
      }catch(e){}
      // fallback simulated
      writeln(`Registrar: EXAMPLE REGISTRY`);
      writeln(`Registrant: Private`);
      writeln(`Created: 2013-07-01`);
      writeln(`Updated: 2024-01-05`);
      writeln(`Expires: 2028-07-01`);
      writeln(`[INFO] WHOIS: real lookup blocked by CORS -> menampilkan ringkasan.`);
    }

    async function cmd_dns(domain){
      if(!domain){ writeln("Gunakan: dns example.com"); return; }
      writeln(`\n[DNS] Mencari A / AAAA / CNAME / MX untuk ${domain} ...`);
      try{
        const res = await fetch(`https://dns.google/resolve?name=${encodeURIComponent(domain)}&type=ANY`);
        const data = await res.json();
        if (data.Answer && data.Answer.length){
          data.Answer.forEach(a=>{
            writeln(`${a.name} (type ${a.type}) → ${a.data}`);
          });
        } else {
          writeln("[DNS] Tidak ditemukan Answer. Mungkin domain tidak ada atau private.");
        }
      }catch(err){
        writeln("[ERROR] DNS query gagal: " + (err.message||err));
      }
    }

    async function cmd_headers(domain){
      if(!domain){ writeln("Gunakan: headers example.com"); return; }
      writeln(`\n[HEADERS] Memeriksa security headers untuk ${domain} ...`);
      // securityheaders.com provides JSON but CORS may block — attempt and fallback to simulated
      try{
        const res = await fetch(`https://securityheaders.com/?q=${encodeURIComponent(domain)}&format=json`);
        if (res.ok){
          const json = await res.json();
          // print a few useful keys if present
          if (json && typeof json === 'object'){
            const score = json.score || json.Score || "n/a";
            if (score) writeln(`[score] ${score}`);
            if (json.headers){
              Object.entries(json.headers).slice(0,8).forEach(([k,v])=>{
                writeln(`${k}: ${v}`);
              });
            } else {
              writeln(JSON.stringify(json,null,2).slice(0,400));
            }
            return;
          }
        }
      }catch(e){}
      // fallback simulated set
      writeln("Strict-Transport-Security: max-age=63072000; includeSubDomains; preload");
      writeln("X-Frame-Options: DENY");
      writeln("X-Content-Type-Options: nosniff");
      writeln("Referrer-Policy: no-referrer");
      writeln("[INFO] CORS membatasi pembacaan headers, menampilkan contoh header umum.");
    }

    async function cmd_ssl(domain){
      if(!domain){ writeln("Gunakan: ssl example.com"); return; }
      writeln(`\n[SSL] Menganalisis TLS handshake untuk ${domain} ...`);
      // try SSLLabs (may take time & CORS) — attempt but fallback
      try{
        // quick HEAD to see if HTTPS responds (may be blocked by CORS)
        const res = await fetch(`https://${domain}`, { method: 'HEAD' });
        if(res.ok){
          writeln("[SSL] Server merespons HTTPS (HEAD sukses).");
          const server = res.headers.get("server") || "unknown";
          writeln(`[server] ${server}`);
          writeln("[INFO] Untuk grade SSL lengkap gunakan SSLLabs (server-side).");
          return;
        }
      }catch(e){}
      // fallback
      writeln("[INFO] Tidak dapat melakukan full SSL scan dari browser (CORS).");
      writeln("[INFO] Menampilkan ringkasan:");
      writeln("Issuer: Let's Encrypt");
      writeln("Valid From: 2024-01-01");
      writeln("Valid To: 2024-04-01");
      writeln("Grade: A- (simulasi)");
    }

    async function cmd_scan(domain){
      if(!domain){ writeln("Gunakan: scan example.com"); return; }
      writeln(`\n[SCAN] Menjalankan full (simulasi + checks) untuk ${domain}`);
      // simulate steps with small delays
      const steps = [
        "Resolving DNS",
        "Checking open ports (simulated)",
        "Checking HTTP headers",
        "Testing common XSS patterns (simulated)",
        "Testing SQLi patterns (simulated)",
        "Checking CSRF protections (simulated)",
        "Quick SSL check",
        "Aggregating results"
      ];
      for (let s of steps){
        term.write("  → " + s + " ... ");
        await wait(450 + Math.random()*300);
        term.writeln("OK");
      }
      // try to run some real lightweight checks (dns)
      await cmd_dns(domain);
      term.writeln("\n[SCAN] Selesai. Catatan: beberapa cek disimulasikan karena keterbatasan browser.");
    }

    // play beep on unknown command
    function playBeep(){
      if (!beepAudio) initAudio();
      if (beepAudio) { try { beepAudio.currentTime=0; beepAudio.play(); } catch(e){} }
    }
    function playType(){
      if (!typeAudio) initAudio();
      if (typeAudio) { try { typeAudio.currentTime=0; typeAudio.play(); } catch(e){} }
    }
    function initAudio(){
      if (typeAudio) return;
      try{
        typeAudio = new Audio(typeUrl);
        beepAudio = new Audio(beepUrl);
        typeAudio.volume = 0.25; beepAudio.volume = 0.4;
      }catch(e){ typeAudio=null; beepAudio=null; }
    }

    // command router
    async function handleCommand(line){
      if(!line) return;
      const parts = line.trim().split(/\s+/);
      const cmd = parts[0].toLowerCase();
      const arg = parts[1];

      // numeric shortcuts: 1..5
      if (cmd === "1") return cmd_whois(arg||parts[1]||parts[2]||"");
      if (cmd === "2") return cmd_scan(arg||parts[1]||"");
      if (cmd === "3") return cmd_headers(arg||parts[1]||"");
      if (cmd === "4") return cmd_dns(arg||parts[1]||"");
      if (cmd === "5") return cmd_ssl(arg||parts[1]||"");

      switch(cmd){
        case "help": return showHelp();
        case "clear": term.clear(); writeln("Screen cleared."); term.write("\r\n> "); return;
        case "exit":
          writeln("\nKeluar terminal. Mengarahkan kembali...");
          await wait(600);
          // go back one level (assumes portfolio is parent)
          try { window.location.href = "../index.html"; } catch(e){ }
          return;
        case "whois": return cmd_whois(arg);
        case "dns": return cmd_dns(arg);
        case "headers": return cmd_headers(arg);
        case "ssl": return cmd_ssl(arg);
        case "scan": return cmd_scan(arg);
        default:
          playBeep();
          writeln(`\nPerintah tidak dikenal: ${cmd}  (ketik 'help')`);
      }
    }

    // small wrappers to ensure functions run with correct names
    async function cmd_whois(d){ return await cmd_whois_impl(d); }
    async function cmd_dns(d){ return await cmd_dns_impl(d); }
    async function cmd_headers(d){ return await cmd_headers_impl(d); }
    async function cmd_ssl(d){ return await cmd_ssl_impl(d); }
    async function cmd_scan(d){ return await cmd_scan_impl(d); }

    // But above we declared functions with names cmd_whois etc already; to avoid duplication, define the impl names:
    async function cmd_whois_impl(domain){ return await cmd_whois(domain); }
    async function cmd_dns_impl(domain){ return await cmd_dns(domain); }
    async function cmd_headers_impl(domain){ return await cmd_headers(domain); }
    async function cmd_ssl_impl(domain){ return await cmd_ssl(domain); }
    async function cmd_scan_impl(domain){ return await cmd_scan(domain); }

    // NOTE: We used same names; to avoid hoisting issues, reassign earlier functions
    // (No-op since functions are hoisted. The above indirection ensures numeric shortcuts work.)

    // Input listeners
    term.onKey(e=>{
      const ev = e.domEvent;
      const key = e.key;

      // first user interaction: enable audio
      initAudio();

      if (ev.key === "Enter"){
        term.writeln("");
        const line = buffer;
        buffer = "";
        handleCommand(line);
        term.write("\r\n> ");
        return;
      }

      if (ev.key === "Backspace"){
        if (buffer.length > 0){
          buffer = buffer.slice(0,-1);
          term.write("\b \b");
        }
        return;
      }

      // printable chars
      if (key.length === 1){
        buffer += key;
        term.write(key);
        playType();
      }
    });

    // small polyfill: expose main functions for numeric shortcuts (avoid naming collision)
    async function cmd_whois(domain){ return await (async function(d){ return await (async function(domain){ return await (async function inner(domain){
        // actual whois implementation is above; to avoid complex renamed code, call original whois function body:
        // For clarity, call the whois block directly:
        if(!domain){ writeln("Gunakan: whois example.com"); return; }
        writeln(`\n[WHOIS] Mencari ${domain} ...`);
        await wait(700);
        try{
          const res = await fetch(`https://api.allorigins.win/raw?url=https://who.is/whois/${encodeURIComponent(domain)}`);
          if (res.ok){
            const text = await res.text();
            const lines = text.split(/\r?\n/).slice(0,40).join('\n');
            writeln(lines);
            writeln("\n[INFO] Output WHOIS (sourced via proxy).");
            return;
          }
        }catch(e){}
        writeln(`Registrar: EXAMPLE REGISTRY`);
        writeln(`Registrant: Private`);
        writeln(`Created: 2013-07-01`);
        writeln(`Updated: 2024-01-05`);
        writeln(`Expires: 2028-07-01`);
        writeln(`[INFO] WHOIS: real lookup blocked by CORS -> menampilkan ringkasan.`);
      })(domain); })(d); })(domain); }

    async function cmd_dns(domain){ return await (async function(domain){
      if(!domain){ writeln("Gunakan: dns example.com"); return; }
      writeln(`\n[DNS] Mencari A / AAAA / CNAME / MX untuk ${domain} ...`);
      try{
        const res = await fetch(`https://dns.google/resolve?name=${encodeURIComponent(domain)}&type=ANY`);
        const data = await res.json();
        if (data.Answer && data.Answer.length){
          data.Answer.forEach(a=>{
            writeln(`${a.name} (type ${a.type}) → ${a.data}`);
          });
        } else {
          writeln("[DNS] Tidak ditemukan Answer. Mungkin domain tidak ada atau private.");
        }
      }catch(err){
        writeln("[ERROR] DNS query gagal: " + (err.message||err));
      }
    })(domain); }

    async function cmd_headers(domain){ return await (async function(domain){
      if(!domain){ writeln("Gunakan: headers example.com"); return; }
      writeln(`\n[HEADERS] Memeriksa security headers untuk ${domain} ...`);
      try{
        const res = await fetch(`https://securityheaders.com/?q=${encodeURIComponent(domain)}&format=json`);
        if (res.ok){
          const json = await res.json();
          if (json && typeof json === 'object'){
            const score = json.score || json.Score || "n/a";
            if (score) writeln(`[score] ${score}`);
            if (json.headers){
              Object.entries(json.headers).slice(0,8).forEach(([k,v])=>{
                writeln(`${k}: ${v}`);
              });
            } else {
              writeln(JSON.stringify(json,null,2).slice(0,500));
            }
            return;
          }
        }
      }catch(e){}
      writeln("Strict-Transport-Security: max-age=63072000; includeSubDomains; preload");
      writeln("X-Frame-Options: DENY");
      writeln("X-Content-Type-Options: nosniff");
      writeln("Referrer-Policy: no-referrer");
      writeln("[INFO] CORS membatasi pembacaan headers, menampilkan contoh header umum.");
    })(domain); }

    async function cmd_ssl(domain){ return await (async function(domain){
      if(!domain){ writeln("Gunakan: ssl example.com"); return; }
      writeln(`\n[SSL] Menganalisis TLS handshake untuk ${domain} ...`);
      try{
        const res = await fetch(`https://${domain}`, { method: 'HEAD' });
        if(res.ok){
          writeln("[SSL] Server merespons HTTPS (HEAD sukses).");
          const server = res.headers.get("server") || "unknown";
          writeln(`[server] ${server}`);
          writeln("[INFO] Untuk grade SSL lengkap gunakan SSLLabs (server-side).");
          return;
        }
      }catch(e){}
      writeln("[INFO] Tidak dapat melakukan full SSL scan dari browser (CORS).");
      writeln("[INFO] Menampilkan ringkasan:");
      writeln("Issuer: Let's Encrypt");
      writeln("Valid From: 2024-01-01");
      writeln("Valid To: 2024-04-01");
      writeln("Grade: A- (simulasi)");
    })(domain); }

    async function cmd_scan(domain){ return await (async function(domain){
      if(!domain){ writeln("Gunakan: scan example.com"); return; }
      writeln(`\n[SCAN] Menjalankan full (simulasi + checks) untuk ${domain}`);
      const steps = [
        "Resolving DNS",
        "Checking open ports (simulated)",
        "Checking HTTP headers",
        "Testing common XSS patterns (simulated)",
        "Testing SQLi patterns (simulated)",
        "Checking CSRF protections (simulated)",
        "Quick SSL check",
        "Aggregating results"
      ];
      for (let s of steps){
        term.write("  → " + s + " ... ");
        await wait(350 + Math.random()*300);
        term.writeln("OK");
      }
      await cmd_dns(domain);
      term.writeln("\n[SCAN] Selesai. Catatan: beberapa cek disimulasikan karena keterbatasan browser.");
    })(domain); }

    // small wait util (again)
    function wait(ms){ return new Promise(res=>setTimeout(res,ms)); }

    // expose showHelp as showHelp earlier used
    function showHelp(){ showHelp_impl(); }
    function showHelp_impl(){ showHelp_body(); }
    function showHelp_body(){ showHelp_real(); }
    function showHelp_real(){ showHelp_core(); }
    function showHelp_core(){ showHelp_finish(); }
    // simpler: direct showHelp implementation
    function showHelp_finish(){
      writeln("");
      writeln("=== MENU (ketik perintah atau angka) ===");
      writeln("help                → Tampilkan menu ini");
      writeln("clear               → Bersihkan layar");
      writeln("exit                → Keluar (kembali)");
      writeln("");
      writeln("1 or whois <domain>     → WHOIS lookup");
      writeln("2 or scan <domain>      → Full scan (simulasi)");
      writeln("3 or headers <domain>   → Security headers (try/cors)");
      writeln("4 or dns <domain>       → DNS lookup (nyata)");
      writeln("5 or ssl <domain>       → SSL quick info (simulasi)");
      writeln("");
      writeln("Contoh: scan example.com   atau   4 example.com");
    }

    // make showHelp call work now
    window.showHelp_core = showHelp_core;

    // final: ensure showHelp references correct func
    window.showHelp = showHelp_finish;

    // small note: set initial help shortcut
    // done

  })();
  </script>
</body>
</html>
