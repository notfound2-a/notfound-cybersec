<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<title>404 CYBERSEC Hacker Terminal</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
/* ---------------- GLOBAL STYLE ---------------- */
body {
    margin: 0;
    background: #000;
    overflow: hidden;
    font-family: "Courier New", monospace;
}

/* ---------------- MATRIX RAIN ---------------- */
canvas#matrix {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    z-index: 1;
    pointer-events: none;
}

/* ---------------- TERMINAL WRAPPER ---------------- */
#terminal-wrap {
    position: relative;
    z-index: 2;
    width: 90%;
    max-width: 900px;
    height: 80vh;
    margin: 30px auto;
    padding: 15px;
    background: rgba(0,0,0,0.75);
    border: 2px solid #00eaff;
    box-shadow: 0 0 25px #00eaff, inset 0 0 30px #0088aa;
    border-radius: 10px;
    overflow-y: auto;
    color: #0ff;
    font-size: 16px;
    white-space: pre-wrap;
    word-break: break-word;
}

/* ---------------- BLINKING CURSOR ---------------- */
.cursor {
    display: inline-block;
    width: 10px;
    height: 18px;
    background: #00f2ff;
    animation: blink 0.6s infinite;
}
@keyframes blink { 0%,100% {opacity:1} 50%{opacity:0} }

/* ---------------- NEW TERMINAL BUTTON ---------------- */
#newTerm {
    position: fixed;
    top: 20px;
    right: 20px;
    padding: 8px 18px;
    background: #00eaff;
    color: #000;
    font-weight: bold;
    border-radius: 6px;
    cursor: pointer;
    z-index: 3;
    box-shadow: 0 0 15px #00eaff;
}
#newTerm:hover {
    box-shadow: 0 0 25px #00ffff;
}

</style>
</head>
<body>

<canvas id="matrix"></canvas>

<div id="newTerm">NEW TERMINAL</div>
<div id="terminal-wrap"></div>

<audio id="typeSound" src="https://assets.mixkit.co/sfx/preview/mixkit-typewriter-soft-hit-1125.mp3"></audio>

<script>
/* ==========================================================
   MATRIX RAIN EFFECT
========================================================== */
const canvas = document.getElementById("matrix");
const ctx = canvas.getContext("2d");
canvas.height = window.innerHeight;
canvas.width = window.innerWidth;

const chars = "01ABCDEFGHIJKLMNOPQRSTUVWXYZ";
const drops = Array(Math.floor(canvas.width / 15)).fill(1);

function matrixRain() {
    ctx.fillStyle = "rgba(0,0,0,0.05)";
    ctx.fillRect(0, 0, canvas.width, canvas.height);
    ctx.fillStyle = "#00eaff";
    ctx.font = "15px Courier";
    drops.forEach((y, i) => {
        const text = chars[Math.floor(Math.random() * chars.length)];
        ctx.fillText(text, i * 15, y * 15);
        drops[i] = y * 15 > canvas.height && Math.random() > 0.975 ? 0 : y + 1;
    });
}
setInterval(matrixRain, 40);

/* ==========================================================
   TERMINAL ENGINE
========================================================== */
const terminal = document.getElementById("terminal-wrap");
const audio = document.getElementById("typeSound");
let input = "";

// play type sound
function playSound() {
    audio.currentTime = 0;
    audio.play();
}

// print text character by character
async function print(text, delay = 5) {
    return new Promise(resolve => {
        let i = 0;
        function typing() {
            if (i < text.length) {
                terminal.innerHTML += text[i];
                playSound();
                i++;
                setTimeout(typing, delay);
            } else resolve();
        }
        typing();
    });
}

function newLine() {
    terminal.innerHTML += "> ";
    createCursor();
    terminal.scrollTop = terminal.scrollHeight;
}

/* blink cursor */
function createCursor() {
    const old = document.querySelector(".cursor");
    if (old) old.remove();
    const c = document.createElement("span");
    c.classList.add("cursor");
    terminal.appendChild(c);
}

/* ==========================================================
   BOOT SEQUENCE
========================================================== */
async function boot() {
    terminal.innerHTML = "";
    await print("BOOTING 404 CYBERSEC TERMINAL...\n", 20);
    await print("Loading kernel modules...\n", 15);
    await print("Initializing matrix engine...\n", 10);
    await print("Ready.\n\n");
    await print("Ketik 'help' atau tekan angka:\n1 WHOIS | 2 SCAN | 3 HEADERS | 4 DNS | 5 SSL\n\n");
    newLine();
}

/* ==========================================================
   SAFE PORT SCAN (browser)
========================================================== */
async function safePortScan(target) {
    const ports = [80, 443, 8080, 3000, 5000, 22, 21];
    let result = "";

    for (let p of ports) {
        try {
            await fetch(`https://${target}:${p}`, { method:"GET", mode:"no-cors" });
            result += `Port ${p} → OPEN\n`;
        } catch {
            result += `Port ${p} → CLOSED\n`;
        }
    }
    return result;
}

/* ==========================================================
   OSINT REAL FUNCTIONS
========================================================== */

async function os_asn(ip) {
    try {
        let r = await fetch(`https://api.bgpview.io/ip/${ip}`);
        let j = await r.json();
        let asn = j.data?.prefixes?.[0]?.asn || "N/A";
        let isp = j.data?.prefixes?.[0]?.name || "N/A";
        await print(` ASN: ${asn}\n ISP: ${isp}\n`);
    } catch {
        await print("Gagal mengambil ASN.\n");
    }
}

async function os_geo(ip) {
    try {
        let r = await fetch(`https://ipapi.co/${ip}/json/`);
        let j = await r.json();
        await print(JSON.stringify(j, null, 2) + "\n");
    } catch {
        await print("GeoIP gagal.\n");
    }
}

async function os_revip(ip) {
    let r = await fetch(`https://api.hackertarget.com/reverseiplookup/?q=${ip}`);
    let t = await r.text();
    await print(t + "\n");
}

async function os_rdns(target) {
    let r = await fetch(`https://api.hackertarget.com/reversedns/?q=${target}`);
    let t = await r.text();
    await print(t + "\n");
}

async function os_headers(domain) {
    try {
        let r = await fetch(`https://${domain}`, { method: "GET" });
        let headers = {};
        r.headers.forEach((v, k) => (headers[k] = v));
        await print(JSON.stringify(headers, null, 2) + "\n");
    } catch {
        await print("Tidak bisa mengambil headers.\n");
    }
}

async function os_ssl(domain) {
    let r = await fetch(`https://api.hackertarget.com/sslinfo/?q=${domain}`);
    let t = await r.text();
    await print(t + "\n");
}

async function os_dns(domain) {
    let r = await fetch(`https://api.hackertarget.com/dnslookup/?q=${domain}`);
    let t = await r.text();
    await print(t + "\n");
}

async function os_shodan(ip) {
    await print("\n[ SHODAN-LITE ]\n");
    await os_geo(ip);
    await os_asn(ip);
}

/* ==========================================================
   SIMULATED SCAN (tetap seperti kode kamu)
========================================================== */
async function runScan(domain) {
    await print(`\n[ SCAN STARTED ] Target: ${domain}\n`);
    await print("--------------------------------------------\n");

    const modules = [
        "XSS Detection",
        "SQL Injection",
        "Command Injection",
        "Directory Traversal",
        "Open Redirect",
        "Security Headers",
        "SSL Certificate",
        "Mixed Content"
    ];

    for (let m of modules) {
        await print(`• Checking ${m}...\n`, 10);
    }
    await print("\nScan complete. No critical issues.\n");
}

/* ==========================================================
   BASIC WHOIS (simulasi)
========================================================== */
async function runWhois(domain) {
    await print(`WHOIS Data for ${domain}\nRegistrar: Cloudflare\nCountry: US\n`);
}

/* ==========================================================
   COMMAND PROCESSOR
========================================================== */
async function commandProcessor(cmd) {
    cmd = cmd.trim();
    if (!cmd) return newLine();

    terminal.innerHTML += "\n";

    // Shortcuts
    if (cmd === "1") return runWhois("example.com");
    if (cmd === "2") return runScan("example.com");
    if (cmd === "3") return os_headers("example.com");
    if (cmd === "4") return os_dns("example.com");
    if (cmd === "5") return os_ssl("example.com");

    /* HELP */
    if (cmd === "help") {
        await print(
`COMMAND:
  whois <domain>
  scan <domain>
  dns <domain>
  ssl <domain>
  headers <domain>
  asn <ip>
  geo <ip>
  revip <ip>
  rdns <domain/ip>
  shodan <ip>
  scanports <domain>
  clear
`);
        return newLine();
    }

    if (cmd === "clear") {
        terminal.innerHTML = "";
        return newLine();
    }

    /* Dynamic Commands */
    if (cmd.startsWith("asn ")) return os_asn(cmd.split(" ")[1]);
    if (cmd.startsWith("geo ")) return os_geo(cmd.split(" ")[1]);
    if (cmd.startsWith("revip ")) return os_revip(cmd.split(" ")[1]);
    if (cmd.startsWith("rdns ")) return os_rdns(cmd.split(" ")[1]);
    if (cmd.startsWith("headers ")) return os_headers(cmd.split(" ")[1]);
    if (cmd.startsWith("dns ")) return os_dns(cmd.split(" ")[1]);
    if (cmd.startsWith("ssl ")) return os_ssl(cmd.split(" ")[1]);
    if (cmd.startsWith("scan ")) return runScan(cmd.split(" ")[1]);
    if (cmd.startsWith("whois ")) return runWhois(cmd.split(" ")[1]);
    if (cmd.startsWith("shodan ")) return os_shodan(cmd.split(" ")[1]);

    if (cmd.startsWith("scanports ")) {
        let d = cmd.split(" ")[1];
        let res = await safePortScan(d);
        await print(res);
        return newLine();
    }

    await print("Perintah tidak dikenal.\n");
    newLine();
}

/* ==========================================================
   KEYBOARD INPUT
========================================================== */
document.addEventListener("keydown", e => {
    const cursor = document.querySelector(".cursor");
    if(cursor) cursor.remove();

    if (e.key === "Enter") {
        terminal.innerHTML += "\n";
        commandProcessor(input);
        input = "";
    } else if (e.key === "Backspace") {
        if (input.length > 0) {
            input = input.slice(0, -1);
            terminal.innerHTML = terminal.innerHTML.slice(0, -1);
        }
    } else if (e.key.length === 1) {
        input += e.key;
        terminal.innerHTML += e.key;
        playSound();
    }

    createCursor();
    terminal.scrollTop = terminal.scrollHeight;
});

/* ==========================================================
   MOBILE TOUCH
========================================================== */
terminal.addEventListener("click", () => {
    const inputEl = document.createElement("input");
    inputEl.style.position = "fixed";
    inputEl.style.opacity = "0";
    document.body.appendChild(inputEl);
    inputEl.focus();

    inputEl.addEventListener("input", e => {
        input += e.target.value;
        terminal.innerHTML += e.target.value;
        e.target.value = "";
        createCursor();
        terminal.scrollTop = terminal.scrollHeight;
    });

    inputEl.addEventListener("blur", () => document.body.removeChild(inputEl));
});

/* ==========================================================
   NEW TERMINAL BUTTON
========================================================== */
document.getElementById("newTerm").onclick = () => boot();

boot();
</script>
</body>
</html>
