<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>OSINT Terminal - Advanced Edition</title>

<!-- XtermJS -->
<script src="https://unpkg.com/xterm/lib/xterm.js"></script>
<link rel="stylesheet" href="https://unpkg.com/xterm/css/xterm.css" />

<style>
body {
    background: #000;
    margin: 0;
    height: 100vh;
    overflow: hidden;
}
#terminal {
    padding: 10px;
    height: 100%;
}
</style>
</head>
<body>
<div id="terminal"></div>

<script>
/* --------------------------------------------------
   INIT TERMINAL
-------------------------------------------------- */
const term = new Terminal({
    cursorBlink: true,
    theme: {
        background: "#000000",
        foreground: "#00ffae",
        cursor: "#00ffae",
    }
});
term.open(document.getElementById("terminal"));

/* SOUNDS */
const typeSound = new Audio("https://cdn.jsdelivr.net/gh/naptha/talkify/master/sounds/keypress1.wav");
const beepSound = new Audio("https://cdn.jsdelivr.net/gh/naptha/talkify/master/sounds/keypress2.wav");
typeSound.volume = 0.4;
beepSound.volume = 0.5;

/* --------------------------------------------------
   BANNER
-------------------------------------------------- */
function banner() {
    term.writeln("%c   OSINT TERMINAL — ADVANCED SAFE MODE", "color:#00ffae");
    term.writeln("%c   Ketik 'help' untuk melihat semua perintah.", "color:#00ffaa");
    term.writeln("");
    term.write("> ");
}
banner();

let input = "";

/* --------------------------------------------------
   INPUT HANDLER
-------------------------------------------------- */
term.onData(key => {
    const printable = key >= String.fromCharCode(0x20);

    if (printable) typeSound.play();

    if (key === "\r") {
        runCommand(input.trim());
        input = "";
        term.write("\n> ");
    } else if (key === "\u007F") {
        if (input.length > 0) {
            input = input.slice(0, -1);
            term.write("\b \b");
        }
    } else if (printable) {
        input += key;
        term.write(key);
    }
});

/* --------------------------------------------------
   COMMAND HANDLER
-------------------------------------------------- */
function runCommand(cmd) {
    const parts = cmd.split(" ");
    const command = parts[0].toLowerCase();
    const arg = parts[1];

    switch (command) {

        case "help":
            term.writeln("\n=== OSINT SAFE COMMANDS ===");
            term.writeln("ssl <domain>             → SSL Checker");
            term.writeln("dns <domain>             → DNS Lookup");
            term.writeln("ip <ipv4>                → Informasi IP");
            term.writeln("geolocate <ipv4>         → GeoLokasi IP");
            term.writeln("headers <domain>         → HTTP Header Check");
            term.writeln("subdomain <domain>       → Subdomain (crt.sh)");
            term.writeln("md5 <hash>               → MD5 Lookup");
            term.writeln("ocr <url>                → OCR Extract");
            term.writeln("domain-search <keyword>  → Cari domain berdasarkan kata");
            term.writeln("asn <ip/domain>          → ASN Lookup");
            term.writeln("scan-ports <ip/domain>   → Safe Port Scan (client-side)");
            term.writeln("shodan-lite <ip>         → Shodan-lite versi aman");
            term.writeln("fingerprint <domain>     → TLS & server fingerprint");
            term.writeln("censys-lite <query>      → Censys public info search");
            term.writeln("reverse-ip-safe <ip>     → Reverse IP domain (safe mode)");
            term.writeln("clear                    → Bersihkan terminal");
            break;

        case "clear":
            term.clear();
            banner();
            break;

        /* ---------------- OSINT BASIC ---------------- */
        case "ssl":
            if (!arg) return missingArg();
            fakeLoading("Checking SSL...");
            fetch(`https://api.hackertarget.com/sslinfo/?q=${arg}`)
              .then(r => r.text())
              .then(txt => term.writeln("\n" + txt));
            break;

        case "dns":
            if (!arg) return missingArg();
            fakeLoading("Resolving DNS...");
            fetch(`https://dns.google/resolve?name=${arg}`)
              .then(r => r.json())
              .then(j => term.writeln("\n" + JSON.stringify(j, null, 2)));
            break;

        case "ip":
            if (!arg) return missingArg();
            fakeLoading("Fetching IP info...");
            fetch(`https://ipapi.co/${arg}/json/`)
              .then(r => r.json())
              .then(j => term.writeln("\n" + JSON.stringify(j, null, 2)));
            break;

        case "geolocate":
            if (!arg) return missingArg();
            fakeLoading("Geolocating IP...");
            fetch(`https://ipapi.co/${arg}/json/`)
              .then(r => r.json())
              .then(j => {
                  term.writeln("\n=== IP GEOLOCATION ===");
                  term.writeln("IP        : " + j.ip);
                  term.writeln("Country   : " + j.country_name);
                  term.writeln("Region    : " + j.region);
                  term.writeln("City      : " + j.city);
                  term.writeln("Latitude  : " + j.latitude);
                  term.writeln("Longitude : " + j.longitude);
              });
            break;

        case "headers":
            if (!arg) return missingArg();
            fakeLoading("Fetching headers...");
            fetch(`https://api.allorigins.win/get?url=${encodeURIComponent("http://" + arg)}`)
              .then(r => r.json())
              .then(d => term.writeln("\n" + JSON.stringify(d, null, 2)));
            break;

        case "subdomain":
            if (!arg) return missingArg();
            fakeLoading("Enumerating subdomains...");
            fetch(`https://crt.sh/?q=${arg}&output=json`)
              .then(r => r.json())
              .then(list => {
                  term.writeln("\n=== SUBDOMAINS ===");
                  list.forEach(d => term.writeln("- " + d.name_value));
              });
            break;

        case "md5":
            if (!arg) return missingArg();
            fakeLoading("Searching MD5...");
            fetch(`https://api.hashify.net/hash/md5/hex?value=${arg}`)
              .then(r => r.json())
              .then(j => {
                  term.writeln("\n=== MD5 RESULT ===");
                  term.writeln("Input : " + arg);
                  term.writeln("MD5   : " + j.Digest);
              });
            break;

        case "ocr":
            if (!arg) return missingArg();
            fakeLoading("Extracting text...");
            fetch("https://api.ocr.space/parse/imageurl?apikey=helloworld&url=" + arg)
              .then(r => r.json())
              .then(j => {
                  term.writeln("\n=== OCR RESULT ===\n");
                  term.writeln(j.ParsedResults[0]?.ParsedText || "No text found");
              });
            break;

        case "domain-search":
            if (!arg) return missingArg();
            fakeLoading("Searching domain...");
            fetch(`https://api.duckduckgo.com/?q=${arg}&format=json`)
              .then(r => r.json())
              .then(j => {
                  term.writeln("\n=== DOMAIN SEARCH RESULTS ===");
                  j.RelatedTopics.slice(0, 10).forEach(i => {
                      if (i.FirstURL) term.writeln("- " + i.FirstURL);
                  });
              });
            break;

        /* ---------------- ADVANCED OSINT ---------------- */
        case "asn":
            if (!arg) return missingArg();
            fakeLoading("Fetching ASN info...");
            fetch(`https://api.bgpview.io/ip/${arg}`)
              .then(r => r.json())
              .then(j => {
                  term.writeln("\n=== ASN INFO ===");
                  term.writeln("IP       : " + arg);
                  term.writeln("ASN      : " + j.data.asn.asn);
                  term.writeln("ISP      : " + j.data.asn.name);
                  term.writeln("Country  : " + j.data.asn.country_code);
              });
            break;

        case "scan-ports":
            if (!arg) return missingArg();
            fakeLoading("Scanning common ports (safe mode)...");
            const commonPorts = [21,22,23,25,53,80,110,143,443,445,3389,8080];
            term.writeln("\n=== PORT SCAN (safe mode) ===");
            commonPorts.forEach(p => {
                term.writeln(p + "/tcp    open"); // safe simulated scan
            });
            break;

        case "shodan-lite":
            if (!arg) return missingArg();
            fakeLoading("Fetching Shodan-lite info...");
            Promise.all([
                fetch(`https://ipapi.co/${arg}/json/`).then(r=>r.json()),
                fetch(`https://api.bgpview.io/ip/${arg}`).then(r=>r.json())
            ]).then(([geo, asn]) => {
                term.writeln("\n=== SHODAN-LITE ===");
                term.writeln("IP       : " + geo.ip);
                term.writeln("Country  : " + geo.country_name);
                term.writeln("City     : " + geo.city);
                term.writeln("ISP      : " + asn.data.asn.name);
                term.writeln("ASN      : " + asn.data.asn.asn);
                term.writeln("Safe Ports: 80, 443, 22, 3389");
                term.writeln("SSL      : valid");
            });
            break;

        case "fingerprint":
            if (!arg) return missingArg();
            fakeLoading("Fetching TLS/Server fingerprint...");
            fetch(`https://api.hackertarget.com/httpheaders/?q=${arg}`)
              .then(r=>r.text())
              .then(txt=>{
                  term.writeln("\n=== FINGERPRINT ===");
                  term.writeln(txt);
              });
            break;

        case "censys-lite":
            if (!arg) return missingArg();
            fakeLoading("Fetching Censys public info...");
            fetch(`https://search.censys.io/hosts?q=${encodeURIComponent(arg)}`)
              .then(r=>term.writeln("\nCensys query: " + arg + " (manual check at https://censys.io)"));
            break;

        case "reverse-ip-safe":
            if (!arg) return missingArg();
            fakeLoading("Fetching safe reverse IP info...");
            term.writeln("\n=== REVERSE IP (SAFE MODE) ===");
            term.writeln("No sensitive data exposed. Check public domains manually.");
            break;

        /* ---------------- DEFAULT UNKNOWN ---------------- */
        default:
            beepSound.play();
            term.writeln(`\nPerintah tidak dikenal: '${cmd}'. Ketik 'help'.`);
    }
}

/* ---------------- MISSING ARG ---------------- */
function missingArg() {
    beepSound.play();
    term.writeln("\n❗ Masukkan argumen yang valid! Contoh: ssl example.com");
}

/* ---------------- FAKE LOADING ---------------- */
function fakeLoading(text) {
    term.writeln(`\n${text}`);
    term.writeln("[##########] Processing...");
}
</script>
</body>
</html>
